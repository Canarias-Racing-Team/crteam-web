---
import NewsCard from "@components/NewsCard.astro";
import Layout from "@layouts/Layout.astro";
import Buttons from "@components/Buttons.astro";
import Section from "@components/Section.astro";
import Card from "@components/Card.astro";
import { getNotionPages } from "@utils/notion";
import { texts } from "@utils/texts";

// Generación de rutas estáticas para cada noticia
export async function getStaticPaths() {
  const pages = await getNotionPages();
  return pages
    .filter((page) => !!page.url)
    .map((page) => ({
      params: { slug: page.url },
      props: { noticia: page },
    }));
}

const { noticia } = Astro.props;

if (!noticia) {
  throw new Error("Noticia no encontrada");
}

const CreateCardContent = () => [
  { type: "title", text: noticia.Nombre },
  { type: "subtitle", text: texts.newsDetail.subtitle[0] },
  { type: "paragraph", text: texts.newsDetail.paragraphs[0] },
  { type: "subtitle", text: texts.newsDetail.subtitle[1] },
  { type: "paragraph", text: texts.newsDetail.paragraphs[1] },
];
---

<Layout id={Astro.self.name}>
  <Section id="noticia-individual" className="py-15 gap-4">
    <Card
      className="w-full lg:w-1/3 bg-base-300 card-xl shadow-sm h-fit"
      content={CreateCardContent()}
    >
      <Buttons
        buttons={[
          {
            text: "Volver a noticias",
            href: "/news",
            icon: "mdi:arrow-left",
          },
        ]}
        size="md"
        className="card-actions justify-end"
      />
    </Card>
    <div class="w-full lg:w-2/3">
      <NewsCard noticia={noticia} />
    </div>
  </Section>
</Layout>
