---
import NewsCard from "@components/NewsCard.astro";
import Layout from "@layouts/Layout.astro";
import Section from "@components/Section.astro";
import Card from "@components/Card.astro";
import { getNotionPages } from "@utils/notion";
import { texts } from "@utils/texts";
import { createCardContent } from "@utils/texts";

// Generación de rutas estáticas para cada noticia
export async function getStaticPaths() {
  const pages = await getNotionPages();
  return pages
    .filter((page) => !!page.url)
    .map((page) => ({
      params: { slug: page.url },
      props: { noticia: page },
    }));
}

const { noticia } = Astro.props;

if (!noticia) {
  throw new Error("Noticia no encontrada");
}
---

<Layout id={Astro.self.name}>
  <Section id="noticia-individual" className="py-15 gap-4">
    <aside
      id="titles"
      class="w-full lg:w-1/3 flex flex-col gap-4 lg:sticky lg:self-start lg:h-fit lg:top-25"
    >
      <Card
        className="w-full bg-base-300 card-xl shadow-sm"
        content={createCardContent(texts.newsDetails.aboutTeam)}
        buttons={[
          {
            text: "Volver a noticias",
            href: "/news",
            icon: "mdi:arrow-left",
          },
        ]}
      />
    </aside>
    <div class="w-full lg:w-2/3">
      <NewsCard noticia={noticia} />
    </div>
  </Section>
</Layout>
